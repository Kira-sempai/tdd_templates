===============
C with CppUTest
===============

=====================  ===========
Programming language:  `C`_
Unit test framework:   `CppUTest`_
Build automation:      `Make`_
=====================  ===========


Structure
=========

Source files
------------

* ``src/main.c``: the main application's entry point
* ``src/module.*``: the main application's functions that shall be tested
* ``test/UnitTests.cc``: unit tests; runs as a separate test application

Makefile targets
----------------

* ``all``: compile everything, i.e application and tests (default target)
* ``clean``: remove all files generated by make
* ``main``: compile and run main application
* ``test``: compile and run test application

Usage: ``$ make <target>``, e.g. ``$ make all`` or just ``$ make`` since it is the default target


Toolchain
=========
This will install all necessary tools::

    $ sudo apt-get install gcc g++ make cpputest


Getting started
===============

Setup
----

1. Clone the repo: ``$ git clone https://github.com/makomi/tdd_templates.git``
2. Enter the template's folder: ``$ cd tdd_templates/C_CppUTest``

TDD
---

A typical TDD cycle consisting of writing a test, writing the function code, and refactoring:

1. Write a test in ``./test/UnitTests.cc``
2. Compile and run the test: ``$ make test``
3. Write function code in ``./src/module.h`` and ``./src/module.c``
4. Compile and run the test: ``$ make test``
5. Refactor if the test passes
6. Repeat

In order to run the application, you will have to also follow these steps:

1. Write application code in ``./src/main.c``
2. Compile and run the application: ``$ make main``

At the end you might want to delete the temporary files: ``$ make clean``

Example
-------

Have a look at the `TDD examples`_ repository to see this template in action.


CppUTest
========

Manual
------

Have a look at the `CppUTest manual <https://cpputest.github.io/manual.html>`_ for information on commonly used assertions, command line switches, additional memory leak detection, mocks, and more.

Scripts
-------

In addition to cloning this repository, it is possible to call scripts located in ``/usr/share/cpputest/scripts/`` to create initial header, source, and Test files. You can find out where on your system *CppUTest* is installed by using ``whereis``::

    $ whereis cpputest
    cpputest: /usr/share/cpputest


.. _C: https://en.wikipedia.org/wiki/C_programming_language
.. _CppUTest: https://cpputest.github.io/
.. _Make: https://en.wikipedia.org/wiki/Make_%28software%29
.. _TDD examples: https://github.com/makomi/tdd_examples/C_CppUTest/
